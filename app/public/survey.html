<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>Friend Finder</title>
    <!-- Latest compiled and minified CSS & JS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="/css/main">

    <script src="https://code.jquery.com/jquery.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js"></script>

</head>

<body>


    <div class="modal" id="myModal" tabindex="-1" role="dialog">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h1 class="modal-title">We found a match!</h1>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">

                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                </div>
            </div>
        </div>
    </div>

    <div class="container">
        <div class="jumbotron">
            <h1>Friend Finder</h1>
            <h3>The greatest resource for platonic friendships!</h3>
            <hr>
            <a href="/">
                <button class="btn btn-danger btn-lg">
                    <span class="fa fa-eye"></span>Home</button>
            </a>
        </div>
        <div class="row">

            <div class="col-lg-12">

                <div class="panel panel-default">
                    <div class="panel-heading">
                        <h3 class="panel-title">
                            <strong>Personality Survey</strong>
                        </h3>
                    </div>
                    <div class="panel-body">
                        <form method="POST" role="form">

                            <div class="form-group">
                                <label for="name">Name</label>
                                <input type="text" class="form-control" id="name">
                            </div>

                            <div class="form-group">
                                <label for="image">Image URL</label>
                                <input type="text" class="form-control" id="image">
                            </div>

                            <div class="form-group">
                                <label for="q1">1) Your mind is always buzzing with unexplored ideas and plans. (1- Strongly Disagree | 5 -
                                    Strongly Agree):</label>
                                <select class="form-control" id="q1">
                                    <option selected>Choose...</option>
                                    <option>1</option>
                                    <option>2</option>
                                    <option>3</option>
                                    <option>4</option>
                                    <option>5</option>
                                </select>
                            </div>

                            <div class="form-group">
                                <label for="q2">2) Generally speaking, you rely more on your experience than your imagination. (1- Strongly
                                    Disagree | 5 - Strongly Agree):</label>
                                <select class="form-control" id="q2">
                                    <option selected>Choose...</option>
                                    <option>1</option>
                                    <option>2</option>
                                    <option>3</option>
                                    <option>4</option>
                                    <option>5</option>
                                </select>
                            </div>

                            <div class="form-group">
                                <label for="q3">3) You find it easy to stay relaxed and focused even when there is some pressure. (1- Strongly
                                    Disagree | 5 - Strongly Agree):</label>
                                <select class="form-control" id="q3">
                                    <option selected>Choose...</option>
                                    <option>1</option>
                                    <option>2</option>
                                    <option>3</option>
                                    <option>4</option>
                                    <option>5</option>
                                </select>
                            </div>

                            <div class="form-group">
                                <label for="q4">4) You rarely do something just out of sheer curiosity. (1- Strongly Disagree | 5 - Strongly
                                    Agree):
                                </label>
                                <select class="form-control" id="q4">
                                    <option selected>Choose...</option>
                                    <option>1</option>
                                    <option>2</option>
                                    <option>3</option>
                                    <option>4</option>
                                    <option>5</option>
                                </select>
                            </div>

                            <div class="form-group">
                                <label for="q5">5) People can rarely upset you. (1- Strongly Disagree | 5 - Strongly Agree):</label>
                                <select class="form-control" id="q5">
                                    <option selected>Choose...</option>
                                    <option>1</option>
                                    <option>2</option>
                                    <option>3</option>
                                    <option>4</option>
                                    <option>5</option>
                                </select>
                            </div>

                            <div class="form-group">
                                <label for="q6">6) It is often difficult for you to relate to other people’s feelings. (1- Strongly Disagree
                                    | 5 - Strongly Agree):</label>
                                <select class="form-control" id="q6">
                                    <option selected>Choose...</option>
                                    <option>1</option>
                                    <option>2</option>
                                    <option>3</option>
                                    <option>4</option>
                                    <option>5</option>
                                </select>
                            </div>

                            <div class="form-group">
                                <label for="q7">7) In a discussion, truth should be more important than people’s sensitivities. (1- Strongly
                                    Disagree | 5 - Strongly Agree):</label>
                                <select class="form-control" id="q7">
                                    <option selected>Choose...</option>
                                    <option>1</option>
                                    <option>2</option>
                                    <option>3</option>
                                    <option>4</option>
                                    <option>5</option>
                                </select>
                            </div>


                            <div class="form-group">
                                <label for="q8">8) You rarely get carried away by fantasies and ideas. (1- Strongly Disagree | 5 - Strongly
                                    Agree):
                                </label>
                                <select class="form-control" id="q8">
                                    <option selected>Choose...</option>
                                    <option>1</option>
                                    <option>2</option>
                                    <option>3</option>
                                    <option>4</option>
                                    <option>5</option>
                                </select>
                            </div>

                            <div class="form-group">
                                <label for="q9">9) You think that everyone’s views should be respected regardless of whether they are supported
                                    by facts or not. (1- Strongly Disagree | 5 - Strongly Agree):</label>
                                <select class="form-control" id="q9">
                                    <option selected>Choose...</option>
                                    <option>1</option>
                                    <option>2</option>
                                    <option>3</option>
                                    <option>4</option>
                                    <option>5</option>
                                </select>
                            </div>

                            <div class="form-group">
                                <label for="q10">10) You feel more energetic after spending time with a group of people.(1- Strongly Disagree
                                    | 5 - Strongly Agree):</label>
                                <select class="form-control" id="q10">
                                    <option selected>Choose...</option>
                                    <option>1</option>
                                    <option>2</option>
                                    <option>3</option>
                                    <option>4</option>
                                    <option>5</option>
                                </select>
                            </div>

                        </form>
                        <br>
                        <div class="text-right">
                            <button type="submit" class="btn btn-primary btn-md" id="add-btn">
                                <span class="fa fa-fire"></span>Find a Friend </button>
                        </div>
                    </div>
                </div>

                <br>
                <hr>
                <a href="api/friends">
                    <span class="fa fa-eye"></span>Api Friends</button>
                </a>
                <a href="/css/background">
                    <span class="fa fa-eye"></span>CSS-Background</button>
                </a>
                <a href="https://nicholaslogan255.github.io/responsive-portfolio/">Profile</a>

            </div>
        </div>
    </div>

    <script type="text/javascript">

        // when submit form button is clicked
        $("#add-btn").on("click", function (event) {
            event.preventDefault();

            // check if name and image link are empty
            if ($("#name").val().trim() == "" || $("#image").val().trim() == "") {
                //alert("You must enter your name and a link to a picture of you.");

                // clear the contents of the modal
                $(".modal-body").empty();

                // change the contents of the modal
                $(".modal-title").text("Error")

                // tell user that name is empty
                if ($("#name").val().trim() == "") {
                    $(".modal-body").append(`<h5>You need to enter your name!</h5>`);
                    $(".modal-body").append("<br>");
                }

                // tell user that name is empty
                if ($("#image").val().trim() == "") {
                    $(".modal-body").append(`<h5>You need to enter a valid image url!</h5>`);
                    $(".modal-body").append("<br>");
                }


                // show the modal
                $("#myModal").modal();
            }
            else {

                 // clear the contents of the modal
                 $(".modal-body").empty();

                //check if all questions have been answered
                var allAnswered = true;

                for (var i = 1; i <= 10; i++) {
                    var quesTag = "#q" + i;
                    console.log(quesTag);

                    if (isNaN($(quesTag).val())) {
                        console.log("Question " + i + " not answered");
                        $(".modal-body").append(`<h2> Question ${i} not answered </h2>`);
                        allAnswered = false;
                    }
                }

                // if all the questions have been answered...
                if (allAnswered) {

                    // create new friend
                    var newEntry = {
                        name: $("#name").val().trim(),
                        photo: $("#image").val().trim(),
                        scores: [
                            $("#q1").val(),
                            $("#q2").val(),
                            $("#q3").val(),
                            $("#q4").val(),
                            $("#q5").val(),
                            $("#q6").val(),
                            $("#q7").val(),
                            $("#q8").val(),
                            $("#q9").val(),
                            $("#q10").val()
                        ]
                    }


                    // posts the new entry to the api/friends
                    $.post("/api/friends", newEntry)
                        .then(function (data) {
                            console.log("data: ", data);

                            // add the name and image of your match
                            $(".modal-title").text("We found a match!")
                            $(".modal-body").append(`<h2>${data.name}</h2>`);
                            $(".modal-body").append("<br>");
                            $(".modal-body").append(`<img src="${data.photo}">`);

                            // show the modal
                            $("#myModal").modal();

                        });

                }
                else { // not all questions answered

                    // add title of the error
                    $(".modal-title").text("Error")
                    
                    // show the modal
                    $("#myModal").modal();

                }


            }


        });
    </script>

</body>

</html>